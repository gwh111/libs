<!DOCTYPE html>
<html lang="en-US">
  <head>
    <meta charset="utf-8">
    <meta name="viewport" content="width=device-width,initial-scale=1">
    <title>库的使用需知 | iOS库的聚集地</title>
    <meta name="description" content="Just playing around">
    
    
    <link rel="preload" href="/libs/assets/css/0.styles.2beb46d8.css" as="style"><link rel="preload" href="/libs/assets/js/app.320b3c70.js" as="script"><link rel="preload" href="/libs/assets/js/2.f97427ac.js" as="script"><link rel="preload" href="/libs/assets/js/11.b4b4751f.js" as="script"><link rel="prefetch" href="/libs/assets/js/10.85894679.js"><link rel="prefetch" href="/libs/assets/js/12.04d9aa81.js"><link rel="prefetch" href="/libs/assets/js/13.cbbf8a04.js"><link rel="prefetch" href="/libs/assets/js/14.d1b1dd7e.js"><link rel="prefetch" href="/libs/assets/js/15.fc717603.js"><link rel="prefetch" href="/libs/assets/js/16.39994558.js"><link rel="prefetch" href="/libs/assets/js/3.6a7ef286.js"><link rel="prefetch" href="/libs/assets/js/4.235e82a3.js"><link rel="prefetch" href="/libs/assets/js/5.d44c9ff6.js"><link rel="prefetch" href="/libs/assets/js/6.18741d6d.js"><link rel="prefetch" href="/libs/assets/js/7.8b439151.js"><link rel="prefetch" href="/libs/assets/js/8.8a58e792.js"><link rel="prefetch" href="/libs/assets/js/9.836e6382.js">
    <link rel="stylesheet" href="/libs/assets/css/0.styles.2beb46d8.css">
  </head>
  <body>
    <div id="app" data-server-rendered="true"><div class="theme-container"><header class="navbar"><div class="sidebar-button"><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" role="img" viewBox="0 0 448 512" class="icon"><path fill="currentColor" d="M436 124H12c-6.627 0-12-5.373-12-12V80c0-6.627 5.373-12 12-12h424c6.627 0 12 5.373 12 12v32c0 6.627-5.373 12-12 12zm0 160H12c-6.627 0-12-5.373-12-12v-32c0-6.627 5.373-12 12-12h424c6.627 0 12 5.373 12 12v32c0 6.627-5.373 12-12 12zm0 160H12c-6.627 0-12-5.373-12-12v-32c0-6.627 5.373-12 12-12h424c6.627 0 12 5.373 12 12v32c0 6.627-5.373 12-12 12z"></path></svg></div> <a href="/libs/" class="home-link router-link-exact-active router-link-active"><!----> <span class="site-name">iOS库的聚集地</span></a> <div class="links"><div class="search-box"><input aria-label="Search" autocomplete="off" spellcheck="false" value=""> <!----></div> <nav class="nav-links can-hide"><div class="nav-item"><a href="/libs/" class="nav-link router-link-exact-active router-link-active">首页</a></div><div class="nav-item"><a href="https://gwh111.github.io/2019/10/11/bench-ios/" target="_blank" rel="noopener noreferrer" class="nav-link external">
  bench_ios开发指南
  <svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg></a></div><div class="nav-item"><a href="http://2.gaopat.sinaapp.com/Team/index.html" target="_blank" rel="noopener noreferrer" class="nav-link external">
  iOS团队
  <svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg></a></div><div class="nav-item"><a href="https://apple@huored.gicp.net:8088/svn/bench_ios/trunk/%E6%96%87%E6%A1%A3/HomePage/index.html" target="_blank" rel="noopener noreferrer" class="nav-link external">
  开发导航
  <svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg></a></div> <!----></nav></div></header> <div class="sidebar-mask"></div> <aside class="sidebar"><nav class="nav-links"><div class="nav-item"><a href="/libs/" class="nav-link router-link-exact-active router-link-active">首页</a></div><div class="nav-item"><a href="https://gwh111.github.io/2019/10/11/bench-ios/" target="_blank" rel="noopener noreferrer" class="nav-link external">
  bench_ios开发指南
  <svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg></a></div><div class="nav-item"><a href="http://2.gaopat.sinaapp.com/Team/index.html" target="_blank" rel="noopener noreferrer" class="nav-link external">
  iOS团队
  <svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg></a></div><div class="nav-item"><a href="https://apple@huored.gicp.net:8088/svn/bench_ios/trunk/%E6%96%87%E6%A1%A3/HomePage/index.html" target="_blank" rel="noopener noreferrer" class="nav-link external">
  开发导航
  <svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg></a></div> <!----></nav>  <ul class="sidebar-links"><li><a href="/libs/" class="active sidebar-link">库的使用需知</a><ul class="sidebar-sub-headers"><li class="sidebar-sub-header"><a href="/libs/#为什么制定规范" class="sidebar-link">为什么制定规范</a></li><li class="sidebar-sub-header"><a href="/libs/#通用代码规范" class="sidebar-link">通用代码规范</a><ul class="sidebar-sub-headers"><li class="sidebar-sub-header"><a href="/libs/#不能出现-建议优化方法" class="sidebar-link">不能出现+建议优化方法</a></li><li class="sidebar-sub-header"><a href="/libs/#bench-ios-代码添加规范" class="sidebar-link">bench_ios 代码添加规范</a></li><li class="sidebar-sub-header"><a href="/libs/#考核建议" class="sidebar-link">考核建议</a></li></ul></li><li class="sidebar-sub-header"><a href="/libs/#使用" class="sidebar-link">使用</a></li><li class="sidebar-sub-header"><a href="/libs/#组件库封装规范" class="sidebar-link">组件库封装规范</a><ul class="sidebar-sub-headers"><li class="sidebar-sub-header"><a href="/libs/#库名的规范" class="sidebar-link">库名的规范</a></li><li class="sidebar-sub-header"><a href="/libs/#包装的规范" class="sidebar-link">包装的规范</a></li><li class="sidebar-sub-header"><a href="/libs/#如果包装的库是实例方法。" class="sidebar-link">如果包装的库是实例方法。</a></li><li class="sidebar-sub-header"><a href="/libs/#如果包装的库都是类方法。" class="sidebar-link">如果包装的库都是类方法。</a></li><li class="sidebar-sub-header"><a href="/libs/#ccs-分类-api-的规范" class="sidebar-link">ccs 分类 API 的规范</a></li><li class="sidebar-sub-header"><a href="/libs/#两种类型" class="sidebar-link">两种类型</a></li><li class="sidebar-sub-header"><a href="/libs/#完整通用系统" class="sidebar-link">完整通用系统</a></li><li class="sidebar-sub-header"><a href="/libs/#通用系统核心组件和功能组件" class="sidebar-link">通用系统核心组件和功能组件</a></li></ul></li><li class="sidebar-sub-header"><a href="/libs/#修改-bench-ios-库" class="sidebar-link">修改 bench_ios 库</a></li></ul></li><li><a href="/libs/通用系统设计规范.html" class="sidebar-link">APP通用系统设计流程</a></li><li><a href="/libs/bench_ios.html" class="sidebar-link">bench_ios</a></li><li><a href="/libs/UITemplateKit.html" class="sidebar-link">UITemplateKit</a></li><li><a href="/libs/AccountLib.html" class="sidebar-link">AccountLib</a></li><li><a href="/libs/FinanceLib.html" class="sidebar-link">FinanceLib</a></li><li><a href="/libs/CurrencyKit.html" class="sidebar-link">CurrencyKit</a></li><li><a href="/libs/LoginKit.html" class="sidebar-link">LoginKit</a></li></ul> </aside> <main class="page"> <div class="theme-default-content content__default"><h1 id="库的使用需知"><a href="#库的使用需知" aria-hidden="true" class="header-anchor">#</a> 库的使用需知</h1> <h2 id="为什么制定规范"><a href="#为什么制定规范" aria-hidden="true" class="header-anchor">#</a> 为什么制定规范</h2> <p>树立规范是为了培养意识，人的意识是按照实物的真实存在+意识的反射形成的，如：
你看到一张纸是白色的，那么首先这张纸有白色的特征，你看到它是白色的（你有学习过什么是白色的概念）所以有了你认为这张纸是白色的意识。</p> <p>这之间就有因果的关系，我们所有的行为都由 <strong>因</strong> 产生，这就是人的意识。你的认知决定你做出的行为，因为你的知识储备使你认为当时这么做是最合适的才会这么去做。
树立规范的理想结果是我们遇到同类的情景时能立即意识到如何编写代码，这一系列过程的产生前期是学习的，后期就是条件反射的，就如大家开车看到红灯就会停下一样自然。</p> <p>这样的好处一是代码变得规范，二是开发者编写代码更流畅，可以把精力投入具体业务中。</p> <h2 id="通用代码规范"><a href="#通用代码规范" aria-hidden="true" class="header-anchor">#</a> 通用代码规范</h2> <p>编码、命名等基础规范。强制类需要强制执行，建议类不强制但要思考你的方法是否在当时情况下是更好的方法，如大量出现需提交给集团讨论。</p> <h3 id="不能出现-建议优化方法"><a href="#不能出现-建议优化方法" aria-hidden="true" class="header-anchor">#</a> 不能出现+建议优化方法</h3> <p>不能出现是指代码编写中不能出现的情况，需要想办法避免，采用建议优化方法去优化，或提出更好的优化方法给我们。</p> <div class="danger custom-block"><p class="custom-block-title">强制</p> <p>【强制】类和文件夹的命名用大驼峰式，属性命名用小驼峰式。
【强制】宏定义全部大写，用_分割。
【强制】图片等资源命名用小写英文单词，用下划线_分割，尽量用业务_模块_功能的格式命名。
【强制】文件夹名称可用中文但不要出现空格、特殊字符。
【强制】使用物理文件夹存放相关类和文件。
【强制】不可出现大量注释掉的代码段，不需要的代码和类及时删除。
【强制】控件的tag用static变量命名，不要直接使用tag，包括魔法数字。
可以通过声明增强语义。static NSInteger passwordErrorTag = 102。
【强制】大量数据解析的接口，UI的初始化和数据加载方法分离，不要在数据解析成功后再初始化UI，防止UI多次重复绘制。
【强制】除新app、紧急项目、紧急bug、回归测试的bug外，代码在分支修改。
【强制】在模拟器不能编译的库用平台语言#忽略，保证项目能可以同时在模拟器和真机运行。
【强制】view、model中不写网络请求，各司其职。
将控制逻辑代码放到控制器里。
【强制】view中不做数据处理，只做赋值显示。数据统一在接口返回后预处理，数据处理尽量放在子线程。
【强制】每个人自己的代码规范保持统一（包括空格、括号、换行的习惯），如果是修改他人文件，按照之前格式或全部改成你的格式。一个文件中不能出现两种风格。保持代码整洁和对齐，不要出现大量空格、特殊符号和换行。
【强制】一个控制器不能超过 <strong>800</strong> 行代码。
如果超过，采用 CC_Controller 拆分单个控制器中的业务模块。
【强制】两个模块的 View 不直接交互，不要出现大量互相依赖。
两个模块通过各自控制器交互，或者统一使用一个类交互。
【强制】发送通知 object 放通知的对象，userInfo 放需要传递的参数。
[[NSNotificationCenter defaultCenter]postNotificationName:@&quot;&quot; object:nil userInfo:nil];
【强制】业务代码方法不能超过 <strong>500</strong> 行代码。
【强制】不要出现引用头文件 但是没有使用。
【强制】使用 BOOL 值，用 YES 和 NO。</p></div> <div class="warning custom-block"><p class="custom-block-title">建议</p> <p>【建议】尽量不要去重写init方法。可以把初始化的代码写在 start 函数中。
默认使用 ccs init: 方法获取对象会首先调用该类的 start 函数（如果有的话）。
【建议】提交代码尽量不要有warning。
【建议】NSString和Block修饰符，使用copy。
【建议】init、viewdidload方法中不要超过10行代码，尽量抽出方法。
【建议】避免数组越界，使用array时，使用array.count确保数据index不越界。
【建议】有数据尽量不写死的想法，可变数据尽量让服务端返回。
【建议】他人写的代码在没有理解的情况，不要轻易删除或修改，找作者帮助。
【建议】判断嵌套不要太多，使用提前return的方式。</p></div> <h3 id="bench-ios-代码添加规范"><a href="#bench-ios-代码添加规范" aria-hidden="true" class="header-anchor">#</a> bench_ios 代码添加规范</h3> <div class="language-swift extra-class"><pre class="language-swift"><code><span class="token number">1</span><span class="token punctuation">.</span> i <span class="token operator">=</span> <span class="token number">3</span><span class="token punctuation">;</span><span class="token comment">//等号或其他符号两边加空格</span>
<span class="token number">2</span><span class="token punctuation">.</span> @property <span class="token punctuation">(</span>nonatomic<span class="token punctuation">,</span>retain<span class="token punctuation">)</span> <span class="token builtin">NSDictionary</span> <span class="token operator">*</span>cc_modelDic<span class="token punctuation">;</span><span class="token comment">//属性</span>
<span class="token number">3</span><span class="token punctuation">.</span> <span class="token punctuation">(</span><span class="token builtin">NSDictionary</span> <span class="token operator">*</span><span class="token punctuation">)</span> <span class="token comment">//类和 * 之间有空格</span>
<span class="token number">4</span><span class="token punctuation">.</span> <span class="token operator">-</span> <span class="token punctuation">(</span>void<span class="token punctuation">)</span>cc_setProperty<span class="token punctuation">:</span><span class="token punctuation">(</span><span class="token builtin">NSDictionary</span> <span class="token operator">*</span><span class="token punctuation">)</span>dic<span class="token punctuation">;</span><span class="token comment">//函数</span>
<span class="token number">5</span><span class="token punctuation">.</span> <span class="token operator">-</span> <span class="token punctuation">(</span>void<span class="token punctuation">)</span>cc_setProperty<span class="token punctuation">:</span><span class="token punctuation">(</span><span class="token builtin">NSDictionary</span> <span class="token operator">*</span><span class="token punctuation">)</span>dic <span class="token punctuation">{</span>
      <span class="token punctuation">}</span><span class="token comment">//函数实现括号前有一个空格</span>
<span class="token number">6</span><span class="token punctuation">.</span> <span class="token keyword">if</span> <span class="token punctuation">(</span><span class="token operator">!</span>value<span class="token punctuation">)</span> <span class="token punctuation">{</span>
      <span class="token comment">//</span>
      <span class="token punctuation">}</span> <span class="token keyword">else</span> <span class="token punctuation">{</span>
      <span class="token comment">//</span>
      <span class="token punctuation">}</span><span class="token comment">//if 和 else 两边有空格</span>
<span class="token number">7</span><span class="token punctuation">.</span> 两行函数之间有一行空格
</code></pre></div><h3 id="考核建议"><a href="#考核建议" aria-hidden="true" class="header-anchor">#</a> 考核建议</h3> <p>在季度谈话中主管抽查代码，找出不合理的部分提问。</p> <ol><li>出现以上 <a href="#%E4%B8%8D%E8%83%BD%E5%87%BA%E7%8E%B0-%E5%BB%BA%E8%AE%AE%E4%BC%98%E5%8C%96%E6%96%B9%E6%B3%95">不能出现</a> 的情况减分。</li> <li>没有使用建议优化方案使用了自己的方案需说明理由，理由不充分者减分，主管记录提交给集团，如采纳作为一个新标准可加分。</li> <li>根据 <a href="#%E7%BB%84%E4%BB%B6%E5%BA%93%E5%B0%81%E8%A3%85%E8%A7%84%E8%8C%83">组件库封装规范</a> 提供功能库成员可酌情加分。</li></ol> <h2 id="使用"><a href="#使用" aria-hidden="true" class="header-anchor">#</a> 使用</h2> <p>如引用库报错，先将引用库都更新到最新版，如一定要使用历史版本出现问题的，联系集团小伙伴。</p> <p>To integrate bench_ios into your Xcode project using CocoaPods, specify it in your <code>Podfile</code>:</p> <div class="language-ruby extra-class"><pre class="language-ruby"><code>platform <span class="token symbol">:ios</span><span class="token punctuation">,</span> <span class="token string">'8.0'</span>

target <span class="token string">'TargetName'</span> <span class="token keyword">do</span>
  pod <span class="token string">'bench_ios'</span>

<span class="token keyword">end</span>
</code></pre></div><h2 id="组件库封装规范"><a href="#组件库封装规范" aria-hidden="true" class="header-anchor">#</a> 组件库封装规范</h2> <p>组件库接入都采用 bench_ios 的扩展的方式。</p> <div class="warning custom-block"><p class="custom-block-title">提示</p> <p>使用 bench_ios 接入组件库 <strong>不需要修改</strong> 组件库已有的任何代码，只是在上面加一层调用规范，同时可以消除依赖。</p></div> <p>bench_ios 可以接入各种库，需要为库添加ccs分类：</p> <ol><li><em><strong>File - New File - Objective-C File</strong></em></li> <li>选择 ***File Type: Category - Class: ccs - File: 库的名称(如 CatPhotoPicker)***。</li> <li>这样就生成了 ccs+库名的分类。</li></ol> <h3 id="库名的规范"><a href="#库名的规范" aria-hidden="true" class="header-anchor">#</a> 库名的规范</h3> <p>库名必须明显，尽可能包含库的功能。
降低使用 <a href="https://gwh111.github.io/2019/10/11/%E8%BD%AF%E4%BB%B6%E8%AE%BE%E8%AE%A1%E7%9A%84%E5%93%B2%E5%AD%A6" target="_blank" rel="noopener noreferrer">认知负荷<svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg></a>，使用者最低学习成本是'知道库名'。</p> <div class="tip custom-block"><p class="custom-block-title">提示</p> <p>在实际使用中，需要 #import &quot;ccs+库名.h&quot;，通过 [ccs 库名_] 就可联想出使用方法。</p></div> <h3 id="包装的规范"><a href="#包装的规范" aria-hidden="true" class="header-anchor">#</a> 包装的规范</h3> <p>假设包装一个 DCBuryPointMgr 的库。包装后使用者可以0依赖调用这个库，通过 ccs+BuryPoint.h 来调用，而 ccs+BuryPoint.h 和 DCBuryPointMgr.h 是没有依赖的。</p> <h3 id="如果包装的库是实例方法。"><a href="#如果包装的库是实例方法。" aria-hidden="true" class="header-anchor">#</a> 如果包装的库是实例方法。</h3> <p>例：如果 DCBuryPointMgr 中有这么一个实例方法。</p> <div class="language-swift extra-class"><pre class="language-swift"><code><span class="token operator">-</span> <span class="token punctuation">(</span>void<span class="token punctuation">)</span>changeFromStrWith<span class="token punctuation">:</span><span class="token punctuation">(</span><span class="token builtin">NSString</span> <span class="token operator">*</span><span class="token punctuation">)</span>changedStr index<span class="token punctuation">:</span><span class="token punctuation">(</span><span class="token builtin">NSInteger</span><span class="token punctuation">)</span>index<span class="token punctuation">;</span>
</code></pre></div><p>在 ccs+BuryPoint.h 中包装成：</p> <div class="language-swift extra-class"><pre class="language-swift"><code><span class="token operator">+</span> <span class="token punctuation">(</span>void<span class="token punctuation">)</span>buryPoint_changeFromStrWith<span class="token punctuation">:</span><span class="token punctuation">(</span><span class="token builtin">NSString</span> <span class="token operator">*</span><span class="token punctuation">)</span>changedStr index<span class="token punctuation">:</span><span class="token punctuation">(</span><span class="token builtin">NSInteger</span><span class="token punctuation">)</span>index<span class="token punctuation">;</span>
</code></pre></div><p>在 ccs+BuryPoint.m 内部这样实现可完全消除依赖：</p> <div class="language-swift extra-class"><pre class="language-swift"><code>id instance <span class="token operator">=</span> <span class="token punctuation">[</span>cc_message cc_targetClass<span class="token punctuation">:</span>@<span class="token string">&quot;DCBuryPointMgr&quot;</span> method<span class="token punctuation">:</span>@<span class="token string">&quot;shareInstance&quot;</span> params<span class="token punctuation">:</span><span class="token constant">nil</span><span class="token punctuation">]</span><span class="token punctuation">;</span>
<span class="token punctuation">[</span>cc_message cc_targetInstance<span class="token punctuation">:</span>instance method<span class="token punctuation">:</span>@<span class="token string">&quot;changeFromStrWith:index:&quot;</span> params<span class="token punctuation">:</span>changedStr<span class="token punctuation">,</span> index<span class="token punctuation">]</span><span class="token punctuation">;</span>
</code></pre></div><p>包装后 <strong>使用者视角</strong></p> <div class="language-swift extra-class"><pre class="language-swift"><code><span class="token punctuation">[</span>ccs buryPoint_changeFromStrWith<span class="token punctuation">:</span>@<span class="token string">&quot;a&quot;</span> index<span class="token punctuation">:</span><span class="token number">3</span><span class="token punctuation">]</span><span class="token punctuation">;</span>
</code></pre></div><h3 id="如果包装的库都是类方法。"><a href="#如果包装的库都是类方法。" aria-hidden="true" class="header-anchor">#</a> 如果包装的库都是类方法。</h3> <p>例：如果 DCBuryPointMgr 中有这么一个类方法。</p> <div class="language-swift extra-class"><pre class="language-swift"><code><span class="token operator">+</span> <span class="token punctuation">(</span>void<span class="token punctuation">)</span>appendEventAction<span class="token punctuation">:</span><span class="token punctuation">(</span><span class="token builtin">NSString</span> <span class="token operator">*</span><span class="token punctuation">)</span>action<span class="token punctuation">;</span>
</code></pre></div><p>在 ccs+BuryPoint.h 中包装成：</p> <div class="language-swift extra-class"><pre class="language-swift"><code><span class="token operator">+</span> <span class="token punctuation">(</span>void<span class="token punctuation">)</span>buryPoint_appendEventAction<span class="token punctuation">:</span><span class="token punctuation">(</span><span class="token builtin">NSString</span> <span class="token operator">*</span><span class="token punctuation">)</span>action<span class="token punctuation">;</span>
</code></pre></div><p>在 ccs+BuryPoint.m 内部这样实现可完全消除依赖：</p> <div class="language-swift extra-class"><pre class="language-swift"><code><span class="token operator">+</span> <span class="token punctuation">(</span>void<span class="token punctuation">)</span>buryPoint_appendEventAction<span class="token punctuation">:</span><span class="token punctuation">(</span><span class="token builtin">NSString</span> <span class="token operator">*</span><span class="token punctuation">)</span>action <span class="token punctuation">{</span>
    <span class="token punctuation">[</span>cc_message cc_targetClass<span class="token punctuation">:</span>@<span class="token string">&quot;DCBuryPointMgr&quot;</span> method<span class="token punctuation">:</span>@<span class="token string">&quot;appendEventAction:&quot;</span> params<span class="token punctuation">:</span>action<span class="token punctuation">]</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span>
</code></pre></div><p>包装后 <strong>使用者视角</strong></p> <div class="language-swift extra-class"><pre class="language-swift"><code><span class="token punctuation">[</span>ccs buryPoint_appendEventAction<span class="token punctuation">:</span>@<span class="token string">&quot;a&quot;</span><span class="token punctuation">]</span><span class="token punctuation">;</span>
</code></pre></div><h3 id="ccs-分类-api-的规范"><a href="#ccs-分类-api-的规范" aria-hidden="true" class="header-anchor">#</a> ccs 分类 API 的规范</h3> <p>分类的API按照 <strong>库名</strong> + <strong>动作</strong> + <strong>with参数</strong> + <strong>参数</strong> 格式编写，使整行阅读有完整的语义，如：</p> <div class="language-swift extra-class"><pre class="language-swift"><code><span class="token operator">+</span> <span class="token punctuation">(</span><span class="token builtin">CatPickerPhotoController</span> <span class="token operator">*</span><span class="token punctuation">)</span>catPhotoPicker_presentViewControllerWithMode<span class="token punctuation">:</span><span class="token punctuation">(</span><span class="token builtin">CatPickerPhotoMode</span><span class="token punctuation">)</span>catPickerPhotoMode delegate<span class="token punctuation">:</span><span class="token punctuation">(</span>id<span class="token punctuation">)</span>delegate viewController<span class="token punctuation">:</span><span class="token punctuation">(</span>id<span class="token punctuation">)</span>viewController<span class="token punctuation">;</span>
</code></pre></div><p>那么在调用时按照 <strong>ccs</strong> + <strong>库名</strong> + <strong>方法</strong> + <strong>传参</strong> 的思想去编写，如：</p> <div class="language-swift extra-class"><pre class="language-swift"><code><span class="token punctuation">[</span>ccs catPhotoPicker_presentViewControllerWithMode<span class="token punctuation">:</span><span class="token builtin">CatPickerPhotoModeMultiple</span> delegate<span class="token punctuation">:</span><span class="token keyword">self</span> viewController<span class="token punctuation">:</span><span class="token keyword">self</span><span class="token punctuation">]</span><span class="token punctuation">;</span>
</code></pre></div><h3 id="两种类型"><a href="#两种类型" aria-hidden="true" class="header-anchor">#</a> 两种类型</h3> <p>我们将封装的库分为两大类：完整通用系统 + 通用系统核心组件和功能组件。
它们的区别在于一个有完整功能，只需要起调API即可，另一个是部分功能，需要自行拼装使用。
因此它们的规范也有部分区别，核心组件和功能组件为了调用更灵活，可以在分类中引入API，即参与链接过程，而完整通用系统调用较为单一，使用运行时消息转发的机制调用，不参与链接可增加启动速度。</p> <h3 id="完整通用系统"><a href="#完整通用系统" aria-hidden="true" class="header-anchor">#</a> 完整通用系统</h3> <p>是指一个完整通用系统，包含核心和UI，一般调用方接入只需一个调用函数和一个返回响应回调即可。<em><strong>可完全解耦 消除依赖。</strong></em></p> <div class="tip custom-block"><p class="custom-block-title">提示</p> <p>完整通用系统 = 通用系统核心 + 通用UI。</p></div> <ol><li>以_库名为前缀，如 <strong>CatPhotoPicker</strong> 这个库（这里当做通用系统库进行封装）：</li></ol> <div class="language-swift extra-class"><pre class="language-swift"><code><span class="token operator">+</span> <span class="token punctuation">(</span>id<span class="token punctuation">)</span>catPhotoPicker_presentSingleModeWithDelegate<span class="token punctuation">:</span><span class="token punctuation">(</span>id<span class="token punctuation">)</span>delegate<span class="token punctuation">;</span>
</code></pre></div><ol start="2"><li>使用 cc_message 实现库方法调用：</li></ol> <div class="language-swift extra-class"><pre class="language-swift"><code><span class="token operator">+</span> <span class="token punctuation">(</span>id<span class="token punctuation">)</span>catPhotoPicker_presentSingleModeWithDelegate<span class="token punctuation">:</span><span class="token punctuation">(</span>id<span class="token punctuation">)</span>delegate <span class="token punctuation">{</span>
    id vc <span class="token operator">=</span> <span class="token punctuation">[</span>cc_message cc_targetClass<span class="token punctuation">:</span>@<span class="token string">&quot;CatPickerPhotoController&quot;</span> method<span class="token punctuation">:</span>@<span class="token string">&quot;controllerWithMode:delegate:&quot;</span> params<span class="token punctuation">:</span><span class="token punctuation">[</span><span class="token builtin">CC_Int</span> value<span class="token punctuation">:</span><span class="token number">0</span><span class="token punctuation">]</span><span class="token punctuation">,</span> delegate<span class="token punctuation">]</span><span class="token punctuation">;</span>
    <span class="token punctuation">[</span>cc_message cc_targetInstance<span class="token punctuation">:</span>vc method<span class="token punctuation">:</span>@<span class="token string">&quot;presentFromRootViewController:&quot;</span> params<span class="token punctuation">:</span>delegate<span class="token punctuation">]</span><span class="token punctuation">;</span>
    <span class="token keyword">return</span> vc<span class="token punctuation">;</span>
<span class="token punctuation">}</span>
</code></pre></div><ol start="3"><li>将所有属性封装成一个 config 方法，调用组件者不需要去组件h文件看有多少属性可以配置：</li></ol> <div class="language- extra-class"><pre class="language-text"><code>
</code></pre></div><ol start="4"><li>最终达到的效果是使用方只需打出库名即可获得全部联想，无需查看组件库文档或h文件：</li></ol> <div class="language-swift extra-class"><pre class="language-swift"><code><span class="token punctuation">[</span>ccs catPhotoPicker_presentSingleModeWithDelegate<span class="token punctuation">:</span><span class="token keyword">self</span><span class="token punctuation">]</span><span class="token punctuation">;</span>
</code></pre></div><h4 id="引用问题"><a href="#引用问题" aria-hidden="true" class="header-anchor">#</a> 引用问题</h4> <p>ccs+CatPhotoPicker.h 文件中不要引用库，即分类.h和.m文件只引用 #import &quot;ccs.h&quot; 。这样组件库才不会参与链接，就可以独立存放。</p> <h4 id="传值问题"><a href="#传值问题" aria-hidden="true" class="header-anchor">#</a> 传值问题</h4> <p>如果需要传递数值而不是对象，使用封装的基础数据如传递数值0：</p> <div class="language-swift extra-class"><pre class="language-swift"><code><span class="token punctuation">[</span><span class="token builtin">CC_Int</span> value<span class="token punctuation">:</span><span class="token number">0</span><span class="token punctuation">]</span>
</code></pre></div><p>传递数值1.20：</p> <div class="language-swift extra-class"><pre class="language-swift"><code><span class="token punctuation">[</span><span class="token builtin">CC_Float</span> value<span class="token punctuation">:</span><span class="token number">1.20</span><span class="token punctuation">]</span>
</code></pre></div><h4 id="注释问题"><a href="#注释问题" aria-hidden="true" class="header-anchor">#</a> 注释问题</h4> <p>封装的分类用描述性语言描述API，尽可能读一遍就清楚API的作用，如特殊情况一定需要添加注释，采用如下格式：</p> <div class="language-swift extra-class"><pre class="language-swift"><code><span class="token comment">/**
 特殊描述
 @param 参数 参数说明
 @return 返回值说明
 */</span>
</code></pre></div><h3 id="通用系统核心组件和功能组件"><a href="#通用系统核心组件和功能组件" aria-hidden="true" class="header-anchor">#</a> 通用系统核心组件和功能组件</h3> <p>通用系统的核心，以及一些UI库等功能性的组件库。<em><strong>没有消除依赖。</strong></em></p> <ol><li>以_库名为前缀，如 <strong>CatPhotoPicker</strong> 这个库（这里当做功能库进行封装）：</li></ol> <div class="language-swift extra-class"><pre class="language-swift"><code><span class="token operator">+</span> <span class="token punctuation">(</span><span class="token builtin">CatPickerPhotoController</span> <span class="token operator">*</span><span class="token punctuation">)</span>catPhotoPicker_presentViewControllerWithMode<span class="token punctuation">:</span><span class="token punctuation">(</span><span class="token builtin">CatPickerPhotoMode</span><span class="token punctuation">)</span>catPickerPhotoMode delegate<span class="token punctuation">:</span><span class="token punctuation">(</span>id<span class="token punctuation">)</span>delegate viewController<span class="token punctuation">:</span><span class="token punctuation">(</span>id<span class="token punctuation">)</span>viewController<span class="token punctuation">;</span>
</code></pre></div><ol start="2"><li>在m文件调用API 实现功能：</li></ol> <div class="language-swift extra-class"><pre class="language-swift"><code><span class="token operator">+</span> <span class="token punctuation">(</span><span class="token builtin">CatPickerPhotoController</span> <span class="token operator">*</span><span class="token punctuation">)</span>catPhotoPicker_presentViewControllerWithMode<span class="token punctuation">:</span><span class="token punctuation">(</span><span class="token builtin">CatPickerPhotoMode</span><span class="token punctuation">)</span>catPickerPhotoMode delegate<span class="token punctuation">:</span><span class="token punctuation">(</span>id<span class="token punctuation">)</span>delegate viewController<span class="token punctuation">:</span><span class="token punctuation">(</span>id<span class="token punctuation">)</span>viewController <span class="token punctuation">{</span>
    <span class="token builtin">CatPickerPhotoController</span> <span class="token operator">*</span>vc <span class="token operator">=</span> <span class="token punctuation">[</span><span class="token builtin">CatPickerPhotoController</span> controllerWithMode<span class="token punctuation">:</span>catPickerPhotoMode delegate<span class="token punctuation">:</span>delegate<span class="token punctuation">]</span><span class="token punctuation">;</span>
    <span class="token punctuation">[</span>vc presentFromRootViewController<span class="token punctuation">:</span>viewController<span class="token punctuation">]</span><span class="token punctuation">;</span>
    vc<span class="token punctuation">.</span>maxCount <span class="token operator">=</span> <span class="token number">2</span><span class="token punctuation">;</span>
    <span class="token keyword">return</span> vc<span class="token punctuation">;</span>
<span class="token punctuation">}</span>
</code></pre></div><ol start="3"><li>最终达到的效果是使用方只需打出库名即可获得全部联想，无需查看组件库文档或h文件：</li></ol> <div class="language-swift extra-class"><pre class="language-swift"><code><span class="token punctuation">[</span>ccs catPhotoPicker_presentViewControllerWithMode<span class="token punctuation">:</span><span class="token builtin">CatPickerPhotoModeMultiple</span> delegate<span class="token punctuation">:</span><span class="token keyword">self</span> viewController<span class="token punctuation">:</span><span class="token keyword">self</span><span class="token punctuation">]</span>
</code></pre></div><ol start="4"><li>如需自定义配置才去获取实例配置响应属性或调用方法：</li></ol> <div class="language-swift extra-class"><pre class="language-swift"><code><span class="token builtin">CatPickerPhotoController</span> <span class="token operator">*</span>pickerPhoto <span class="token operator">=</span> <span class="token punctuation">[</span>ccs catPhotoPicker_presentViewControllerWithMode<span class="token punctuation">:</span><span class="token builtin">CatPickerPhotoModeMultiple</span> delegate<span class="token punctuation">:</span><span class="token keyword">self</span> viewController<span class="token punctuation">:</span><span class="token keyword">self</span><span class="token punctuation">]</span><span class="token punctuation">;</span>
pickerPhoto<span class="token punctuation">.</span>maxCount <span class="token operator">=</span> <span class="token number">5</span><span class="token punctuation">;</span>
</code></pre></div><h2 id="修改-bench-ios-库"><a href="#修改-bench-ios-库" aria-hidden="true" class="header-anchor">#</a> 修改 bench_ios 库</h2> <div class="danger custom-block"><p class="custom-block-title">提示</p> <p>对于 bench_ios 的任何改动都要谨慎，特别是改动API，改动API需要检查其他库主干情况，如有调用到该API，需要及时修改，保证其他库打出的新版本没有问题。</p></div></div> <footer class="page-edit"><!----> <!----></footer> <div class="page-nav"><p class="inner"><!----> <span class="next"><a href="/libs/通用系统设计规范.html">APP通用系统设计流程</a>
      →
    </span></p></div> </main></div><div class="global-ui"></div></div>
    <script src="/libs/assets/js/app.320b3c70.js" defer></script><script src="/libs/assets/js/2.f97427ac.js" defer></script><script src="/libs/assets/js/11.b4b4751f.js" defer></script>
  </body>
</html>
